\ LOADBLOCK 2            < 8/13/86>140                                          \ Load this block after loading block   \ 141                                                                           [FORTH]                                   145 LOAD  \ new defaults                142 LOAD  \ logo word                   146 LOAD  \ kludges                   [FORTH]                                 \ -1 SAVE-VDP +! PUT-LOADER             WRITE-LOADER                            MARK-FORGET                             UNPATCH 3 BUFFERS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \ LOADBLOCK              < 1/20/87>141  PAGE                                    ." Loading BIOLOGY (GEN) extensions"    CR CR CR PATCH                            144 LOAD  \ DISK AREA DEFS              277 LOAD  \ BRODYFONT                   150 182 THRU                            183 199 THRU \ Misc stuff               200 209 THRU \ TURNKEY                  210 261 THRU \ PUNNETT WORDS            147     LOAD \ init variables         [FORTH]                                 140 LOAD EXIT                           CR CR                                   ." Load any additional code now." CR    ." Then load screen 140 to finish" CR   ." the system." CR CR                                                           EXIT                                                                                                                                                                                                                                                                                                            ( BLOGO                  < 1/20/87>142)                                         [FORTH]                                 APPENDIX                                0 CONSTANT GENC                         : BLOGO                                   <OPDB-LOGO>                             ." Biology (Gen" GENC EMIT              ." ) V1.24 " .M/D/Y                     ."  (fah)" CR                         ;                                                                               MAIN                                    ' BLOGO CFA ' LOGO !                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \ MAKE AUTO BOOT         < 5/13/86>143                                                                                                                          : Q                                       256 @ 1234 = IF <ABORT> THEN            TURNKEY ;                                                                     3 BUFFERS                               ' Q CFA ' START-SYS !                   ' Q CFA ' ABORT !                       ' Q CFA ' BRK-RETN !                    ' EXIT CFA ' LOGO !                     ' EXIT CFA ' FORGET-SYS !                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ DISK AREA DEFINITIONS  <12/16/86>144                                                                                  2 VSTART 140 VEND \ 138 BLOCKS AVAIL                                            \ leave first 2 blocks for a program    \ to tell user this is a data disk                                               8   VSIZE OVERLAYS                     39 REVSIZE PICS                          5 REVSIZE MSG-PTRS                     38 REVSIZE MSG-TEXT                     48 REVSIZE OPDB                                                                 VLEFT?                                                                                                                                                                                                                                                                                                                                                                                                 \ FAH                                                                    \ NEW DEFAULTS           < 5/13/86>145  \ values set here (unless changed later)\ will be the system defaults                                                     EXEC                                    1 TO 1stVar# ( allow change to P/L )    12 P/L !                                BL M-CHAR ! 9 M-BLINK !                 0 M-ON ! 0 M-OFF !                      1 DX' ! 1 DY' ! 1 DX ! 1 DY !           15 LMARG !  13 TMARG !                  3 SUBAMT !                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \ FAH                                                                    (                        < 6/26/86>146)                                         [FORTH]                                 : MLIST                                   ' EXIT CFA EXEC ' PROCESS-MSG !         MLIST ;                                                                       : MPRINT                                  ' EXIT CFA EXEC ' PROCESS-MSG !         MPRINT ;                                                                      : RUN                                     EXEC ' FILTER CFA ' PROCESS-MSG !       RUN ;                                                                                                                                                                                                                                                                                                                                                                                                                                        ( FAH  )                                                                 \ INIT VARIABLES         < 1/20/87>147                                          10 TX !                                 125 TY !                                10 PX !                                 180 PY !                                11 P/L !                                                                        CR CR                                   ." MARGIN VARIABLES INITIALIZED."       CR CR                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \ PREDEFINED VARIABLES   < 1/20/87>150                                          [FORTH]                                 \ temporary variables                   LOADER PREVAR INT TINT                  LOADER PREVAR CHAR TCHAR                LOADER PREVAR LOGIC FLAG                \ system vars                                                                   \ location of areas on screen           LOADER PREVAR INT TX \ main text area   LOADER PREVAR INT TY                    LOADER PREVAR INT PX \ prompt area      LOADER PREVAR INT PY                    LOADER PREVAR INT CX \ command area     LOADER PREVAR INT CY                                                                                                    \ sub/super-script amount               LOADER PREVAR INT SUBAMT                                                                                                                                                                       \ FAH                                                                    \ PREDEFINED VARIABLES   < 1/20/87>151  [FORTH]                                                                         \ values returned bye PUN-OFF           LOADER PREVAR INT PRIM                  LOADER PREVAR INT SEC                                                                                                                                           \ update pointers for loader            LOADER VAR# @ EXEC TO 1stUserVar#       EXEC VP @ TO UserVP                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \ FAH                                                                    \ PREDEFINED VARIABLES   < 1/20/87>152                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \ FAH                                                                    \ 0MODE 1MODE 2MODE 3MODE< 1/20/87>153                                          : ISMODE                                  CREATE C,                               DOES> C@ SETMODE ;                                                            0 ISMODE 0MODE                          1 ISMODE 1MODE                          2 ISMODE 2MODE                          3 ISMODE 3MODE                          4 ISMODE 4MODE                          5 ISMODE 5MODE                                                                  EXIT                                                                                                                    : INXY                                    [COMPILE] INGXY                       ; IMMEDIATE                                                                                                                                                                                                                            \ FAH                                                                    \ KEY:                   < 1/20/87>154                                          [FORTH]                                                                         : KEY:                                    STATE @ ABORT" NO NESTING"              [KEYWORDS]                              [COMPILE] : ; IMMEDIATE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \ FAH                                                                    \ GY/N                   < 1/20/87>155                                          [EXEC]                                                                          \ wait for Y or N while flashing cursor                                         : GY/N ( -- T/F; T if Y pressed)          BEGIN GKEY TOUC DUP ASCII Y =            OVER ASCII N = OR NOT                  WHILE DROP REPEAT                       ASCII Y = ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \ FAH                                                                    \ MOVE                   < 1/20/87>156                                          \ Allows you to move cursor without     \ updating LASTX or LASTY               EXCODE: \ X Y --                          CURY ! CURX ! CLEANUP                 EX;                                                                             \ USE: MOVE X Y                         KEY: MOVE                                 LOADER INSCR?                           TYPES INT LOADER GET-EXPR               TYPES INT LOADER GET-EXPR               !EXCODE ;                                                                                                                                                                                                                                                                                                                                                                                                                                    \ FAH                                                                    \ NL                     < 1/20/87>157                                          [EXEC]                                  \ sames as: AT LASTX , LASTY + P/L      : DONL                                    LASTX @ CURX ! LASTY @ P/L @            + DUP LASTY ! CURY !                  ;                                                                               IS-EXCODE DONL                                                                  \ use: NL                               KEY: NL                                   LOADER INSCR? !EXCODE ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ NL-IND                 < 1/20/87>158                                          \ same as: AT LASTX , LASTY + 10        \          LET CURX := CURX + 15        EXCODE: \ -- ;                            LASTX @ 15 + CURX !                     LASTY @ 10 + DUP LASTY ! CURY ! EX;                                           \ USE: NL-IND                           KEY: NL-IND                               LOADER INSCR? !EXCODE ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \ FAH                                                                    \ #B G.DATE .DATE G.     < 1/20/87>159                                          [FORTH]                                 : G. ( N -- )                             0 <# #S #> GTYPE ;                                                            EXIT -----                                                                      : #B \ blank if all done                  DDUP OR 0=                              IF BL HOLD ELSE # THEN ;                                                      : DATE>$ ( M D Y -- ADR CNT )             0 <# # # 47 HOLD DDROP                     0 # # 47 HOLD DDROP 0 # #B #> ;                                            : G.DATE ( M D Y -- ) DATE>$ GTYPE ;    : .DATE ( M D Y -- ) DATE>$ TYPE ;                                                                                                                                                                                                                                             \ FAH                                                                    \ SET-RANGE              < 1/20/87>160                                          [EXEC]                                  -1 CONSTANT MAX-GETN  ( UNSIGNED VAL )   0 CONSTANT MIN-GETN                                                            EXCODE: ( LO HI -- )                      TO MAX-GETN                             TO MIN-GETN                           EX;                                                                                                                     [KEYWORDS]                              \ USE: SET-RANGE lo , hi                : SET-RANGE                               LOADER INSCR?                           TYPES INT LOADER GET-EXPR               TYPES INT LOADER GET-EXPR               !EXCODE ;                                                                                                                                                                                                                            \ FAH                                                                    \ INPUT                  < 1/20/87>161  \ will only input INT CAR or STR        \ ARG: var# C,                          EXCODE: ( -- )                            @1ARG DUP @VTYPE                        DUP TYPES INT = SWAP CAR = OR           IF EXEC >R MIN-GETN MAX-GETN               PAD 7 GETN R> @VADDR !               ELSE                                     DUP @VTYPE TYPES STR = NOT EXEC         RUN-ERR" Wrong type in INPUT"           @VADDR DUP 1+ SWAP C@ ( MAX )           GINPUT THEN                             0 TO MIN-GETN -1 TO MAX-GETN           CLEANUP EX;                                                                   \ USE: INPUT var                        KEY: INPUT                                LOADER INSCR?                           GET-VAR-NUM DUP EXEC 1stVar# <          ABORT" Can't change this variable"      LOADER !EXCODE C,OPDB ;                                                                                      \ FAH                                                                    \ REPCHAR REP            < 1/20/87>162  [EXEC]                                  ASCII @ XCONST REPCHAR                  \ REPCHAR followed char below will      \ be replace by item indicated          XCREATE REP                               ASCII R C, 4 C, ( RIGHT ARROW )         ASCII L C, 5 C, ( LEFT ARROW )          ASCII U C, 2 C, ( UP ARROW )            ASCII D C, 3 C, ( DOWN ARROW )          ASCII W C, 18 C, ( up )                 ASCII Z C, 19 C, ( down )               ASCII 0 C, 20 C, ( sub 1 )              ASCII 1 C, 21 C, ( sub 2 )              ASCII 2 C, 22 C, ( sub 3 )              ASCII 3 C, 23 C, ( sub 4 )              ASCII 4 C, 24 C, ( sub 5 )              ASCII 5 C, 25 C, ( sub 6 )              ASCII 6 C, 26 C, ( sub 7 )              ASCII 7 C, 27 C, ( sub 8 )              ASCII 8 C, 28 C, ( sub 9 )              ASCII 9 C, 29 C, ( sub 10 )             0 , ( END OF TABLE)                                                  \ FAH                                                                    \ FILTER PRIMS/VARS      < 1/20/87>163  [EXEC]                                  XCREATE GARBAGE                         XVAR SCNT                               XVAR ^DST                               XVAR -CASE-                             XVAR CHANGED?                                                                   X: !DST ( B -- )                          ^DST @ DUP C@ + 1+ C!                   1 ^DST @ +C! X;                                                               X: @SRC ( -- B )                          MSG-BUF SCNT @ + 1+ C@                  1 SCNT +! X;                                                                  X: ^SRC ( -- ADR )                        MSG-BUF SCNT @ + 1+ X;                                                        X: DONE? ( -- T/F )                       SCNT @ MSG-BUF C@ < NOT X;                                                                                                                           \ FAH                                                                    \ REPTRAN                < 1/20/87>164                                          [EXEC]                                                                          X: REPTRAN ( C -- C' )                    REP                                     BEGIN                                    DUP C@ 3 PICK OVER UC= NOT              SWAP 0= NOT AND                        WHILE 2+ REPEAT                         DUP C@                                  IF 1 CHANGED? !                           SWAP DROP 1+ C@                       ELSE DROP                               THEN X;                                                                                                                                                                                                                                                                                                                                                                                              \ FAH                                                                    \ FILTER                 < 1/20/87>165  [EXEC]                                  : FILTER                                  0 PAD ! PAD ^DST !                      0 SCNT ! 0 CHANGED? !                   BEGIN DONE? NOT                         WHILE @SRC                               DUP REPCHAR =                           IF DROP @SRC REPTRAN THEN               !DST                                   REPEAT                                  CHANGED? @ ( COPY STRING BACK? )        IF ^DST @ DUP C@ 1+                       MSG-BUF SWAP CMOVE                    THEN ;                                                                        FORGET GARBAGE                          REVECTOR FILTER INTO PROCESS-MSG        CR ." FILTER installed" CR                                                                                                                                                                                                             \ FAH                                                                    \ <GEMIT>                < 1/20/87>166                                          \ for chars 20-29:                      \   - lower subamt                      \   - print number (n+28)               \   - raise subamt                                                              : <GEMIT> \ C -- ;                        DUP 20 29 WITHIN                        IF SUBAMT @ GY +!                        28 + <GEMIT>                            SUBAMT @ NEGATE GY +!                  ELSE DUP 18 = \ up?                      IF DROP SUBAMT @ NEGATE GY +!           ELSE DUP 19 = \ down?                    IF DROP SUBAMT @ GY +!                  ELSE <GEMIT> THEN                      THEN                                   THEN ;                                                                                                                ' <GEMIT> CFA ' GEMIT !                                                                                        \ FAH                                                                    \ Y/N?                   < 1/20/87>167                                          \ spaces over and waits for Y/N         \ Prints response                       EXCODE: ( -- )                            EAT-KEYS 78 ( N )                       GSPACE GY/N DUP FLAG C!                 11 * + GEMIT  EX;                                                                                                     KEY: Y/N?                                 LOADER INSCR? !EXCODE ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \ FAH                                                                    \ WAIT                   < 1/20/87>168                                                                                  IS-EXCODE WAIT                                                                  KEY: WAIT                                 LOADER INSCR?                           TYPES INT LOADER GET-EXPR               !EXCODE ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \ FAH                                                                    \ {HILIT} <HILIT>        < 1/20/87>169                                          [EXEC]                                  10 CONSTANT HL-HT                                                               : {HILIT} ( w n ; hilit item n with )     GXY@ >R >R GETMODE >R                   >R      ( bar that is w wide )          0 SETMODE                               ( W ) HL-HT ( height )                  R@ 0 ^MITEMS @  ( xlocation ) 5 -       R> 2 ^MITEMS @  ( ylocation )           BAR                                     R> SETMODE R> R> GXYTAB ;                                                     : <HILIT>                                 10 ' HL-HT ! {HILIT} ;                                                                                                                                                                                                                                                                                               \ FAH                                                                    \ HILIT 1HILIT           < 1/20/87>170                                          EXCODE: ( W -- ; when running menu )      M-ITEM# @ <HILIT>                       CLEANUP EX;                                                                   KEY: HILIT                                LOADER INSCR?                           TYPES INT LOADER GET-EXPR               !EXCODE ;                                                                     EXCODE: ( W -- ; During creation only )   #MITEMS @ <HILIT>                       CLEANUP EX;                                                                   KEY: 1HILIT                               LOADER INSCR?                           TYPES INT LOADER GET-EXPR               !EXCODE ;                                                                                                                                                                                                                            \ FAH                                                                    \ BDKEY                  < 1/20/87>171  [FORTH]                                 \ this is my back door.                 \ Press control-f with both             \ apple keys down                       \ only used when waiting for keys       \ in the disk error words                                                       : BDKEY \ -- KEY                          KEY                                     DUP 6 = 49249 C@ 127 > AND              49250 C@ 127 > AND                      IF DROP TEXT KEY DROP PAGE                ." HI FRED" CR CR <ABORT> THEN ;                                                                                                                                                                                                                                                                                                                                                                                                           \ FAH                                                                    \ INSDISK                < 1/27/87>172  [FORTH]                                 ' <DISKERR> CFA CONSTANT ^DISKERR                                                   0 CONSTANT DBLK \ B=3 P=0           20551 CONSTANT DID  \ B=16967 P=20551       2 CONSTANT DS   \ B=1 P=2                                                   : PDISK? \ -- T; t=means proper disk      REVECTOR NOOP INTO DISKERR              EMPTY-BUFFERS DBLK BLOCK @              DID = DISK-ERROR @ 0= AND               ^DISKERR TO DISKERR ;                                                         : INSDISK \ -- insert disk with DID       BEGIN PDISK? NOT                        WHILE PAGE TEXT 7 10 XYTAB                ." INSERT SIDE " DS .                   ." OF THE DISK"                         11 12 XYTAB ." INTO DRIVE 1, THEN"      14 14 XYTAB ." PRESS SPACE"             BEGIN BDKEY BL = UNTIL                REPEAT ;                                                             \ FAH                                                                    \ MYRESET                < 1/20/87>173  [FORTH]                                                                         VARIABLE BRK-SCR                        \ holds the OpDB address of the         \ screen to run when reset is pressed                                           : MYRESET                                 MODE40 INSDISK CLS HG                   5 SETMODE DX' @ DX !                    0 34 C! ( reset text margin )           BRK-SCR @ EXEC DEP !                    BEGIN READ-SCR NOT                      WHILE SCR-BUF RUN-CODE REPEAT           RUN-ERR" Brk screen exited"           ;                                                                                                                                                                                                                                                                                                                                                              \ FAH                                                                    \ BRK-SCREEN             < 1/20/87>174  \ use: BRK-SCREEN name                  \ vectors in MYRESET into BRK-RETN      \ when crtl-RESET is pressed            \ control will transfer to this screen                                          \ args: ADR ,                           EXCODE: \ -- ;                            REVECTOR MYRESET INTO BRK-RETN          @2ARG BRK-SCR ! EX;                                                           ( use: BRK-SCREEN name )                KEY: BRK-SCREEN ( -- ; )                  LOADER INSCR?                           !EXCODE <INTER> ;                                                                                                                                                                                                                                                                                                                                                                                    \ FAH                                                                    \ >RLAST RETRY           < 1/20/87>175  [FORTH]                                 CREATE RLAST 14 ALLOT                                                           : >RLAST \ copys to 7 args to RLAST       SP@ RLAST 14 CMOVE ;                                                          \ retrys last argument saved by         \ >RLAST returns error status           \                                       \ /\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\  \ \ DOES NOT GO TO DISKERR if error  /  \  \/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/                                           HEX                                     : RETRY \ -- Err ; retry last             0 0C                                    DO RLAST I + @ -2 +LOOP                 RLAST @ 6 PICK 10 * B7E9 C!             <RWTS> DUP DISK-ERROR ! ;                                                     DECIMAL                                                                                                        \ FAH                                                                    \ RWTS PATCH             < 1/20/87>176  [FORTH]                                                                         \ saves calling arguments so it can     \ be retried if error                                                           \ ' [RWTS] CFA ' RWTS ! enables         \ ' DEPTH CFA ' RWTS ! disables                                                 : [RWTS] ( <7 ARGS> -- <7 ARGS> DEPTH )   >RLAST DEPTH ;                                                                                                        ' [RWTS] CFA ' RWTS !                   CR CR ." RWTS PATCHED" CR CR                                                                                                                                                                                                                                                                                                                                                                           \ FAH                                                                    \ .DERR                  < 1/20/87>177  [FORTH]                                 \ if space pressed, return              \ else execute BRK-RETN                 : .DERR ( -- ; print message )            PAGE TEXT CR 1500 50 TONE               7 7  XYTAB                              ." A DISK ERROR HAS OCCURRED"           7 8 XYTAB OUT @ 0 DO 45 EMIT LOOP       9 11 XYTAB                              ." CHECK DISK AND DRIVE"                7 13 XYTAB                              ." THEN PRESS SPACE TO RETRY"           5 15 XYTAB                              ." OR ESC TO RETURN TO MAIN MENU"       BEGIN BDKEY DUP BL = OVER 27 = OR NOT   WHILE DROP REPEAT                       27 =                                    IF HG BRK-RETN <ABORT> THEN             PAGE ;                                                                                                                                                                                       \ FAH                                                                    \ DISK-OOPS              < 1/20/87>178  \ handles disk errors                   \ does not destroy HI-RES screen        \ Will leave in text mode               \ if csw does not point to ROM          [FORTH]                                   XVAR OLDCSW                           : DISK-OOPS                               54 @ OLDCSW !  \ output routine         BEGIN .DERR    \ tell user                    INSDISK  \ right disk?                  RETRY 0= \ until succesful        UNTIL                                   PAGE           \ clear text screen      OLDCSW @ DUP 65008 =                    \ 65008=adr of screen output routine    IF HG THEN     \ if not printing        54 ! ;         \ restore COUT routine                                         REVECTOR DISK-OOPS INTO DISKERR CR CR   REVECTOR DISK-OOPS TO ^DISKERR CR CR    ." DISKERR REVECTORED INTO DISK-OOPS"   CR CR                                                                  \ FAH                                                                    \ PAREA                  < 1/20/87>179                                          \ move cursor to prompt area (PX,PY)                                            EXCODE: \ -- ;                            PX @ PY @                               DDUP LASTY ! LASTX !                    CURY ! CURX ! EX;                                                             KEY: PAREA                                LOADER INSCR? !EXCODE ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \ FAH                                                                    \ TAREA                  < 1/20/87>180                                          \ move cursor to text area (TX,TY)                                              EXCODE: \ -- ;                            TX @ TY @                               DDUP LASTY ! LASTX !                    CURY ! CURX ! EX;                                                             KEY: TAREA                                LOADER INSCR? !EXCODE ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \ FAH                                                                    \ CAREA                  < 1/20/87>181                                          \ move cursor to text area (CX,CY)                                              EXCODE: \ -- ;                            CX @ CY @                               DDUP LASTY ! LASTX !                    CURY ! CURX ! EX;                                                             KEY: CAREA                                LOADER INSCR? !EXCODE ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \ FAH                                                                    \ RANDOM                 < 1/20/87>182                                          [FORTH]                                                                         VARIABLE SEED 0 SEED !                                                          : RANDOM ( N -- I; 0<=I<N )                SEED @ U* SWAP DROP                     SEED @ 27517 U* 2311 0 D+               DROP SEED ! ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ FAH                                                                    \ ORD-INIT               < 1/20/87>183  EXIT -------------------------------    [EXEC]                                  5 XCONSTANT #PK                         XCREATE ORDS 10 ALLOT                                                           X: +TINT ( N -- )                          TINT @ + #PK + #PK MOD TINT ! X;                                             X: OPICKD? ( -- T/F )                      ORDS TINT @ + C@ X;                                                          X: FINDNXT ( I -- ) #PK 0                  DO DUP +TINT OPICKD? 0=                  IF LEAVE THEN LOOP                     DROP X;                                                                      EXCODE: ( -- )                           ORDS 10 0 FILL EX;                                                             KEY: ORD-INIT                            LOADER INSCR? !EXCODE ;                                                                                       \ FAH                                                                    \ PICK-ORD               < 1/20/87>184  EXIT -------------------------------    \ set TINT to item picked               EXCODE: ( N -- )                          X' #PK ! 0 TINT ! #PK 0                 DO OPICKD?                               IF 1 +TINT ELSE LEAVE THEN             LOOP                                    BEGIN LASTY @ TINT @ P/L @ * +           CURY ! GKEY                             DUP 11 = IF -1 FINDNXT THEN             DUP 10 = IF 1 FINDNXT THEN             13 = UNTIL                              1 ORDS TINT @ + C!                      CLEANUP EX;                           \ USE:                                  KEY: PICK-ORD                             LOADER INSCR?                           TYPES INT LOADER GET-EXPR               !EXCODE ;                             [EXEC] FORGET ORDS                                                                                                                                     \ FAH                                                                    \ MARK PRIMS             < 1/20/87>185                                          [EXEC]                                  50 CONSTANT #MARKS                      \ 0=no ESC allowed                      \ adr=Start GOSUB-STACK ptr             VARIABLE ESCMARK                                                                CREATE MARKS                              1 ALLOT \ current count                 #MARKS 2* ALLOT \ location                                                    \ address of the current mark item      : ^MARK \ -- ADR ;                         MARKS 1+                                MARKS C@ 2* + ;                                                              \ T= last mark is this screen           : TMARK? ( -- )                            ^MARK 2- @ LAST-DEP @ = ;                                                                                                                                                                   \ FAH                                                                    \ MARK-INIT MARK         < 1/20/87>186                                          \ ARG n C, \ true means ESC allowed     EXCODE: \ clear the table                 @1ARG                                   IF GSTACK @ ELSE 0 THEN                 ESCMARK ! MARKS #MARKS 0 FILL EX;                                             KEY: MARK-INIT  ( ESC not allowed)        LOADER INSCR? !EXCODE 0 C,OPDB ;                                              KEY: MARK-ESC  ( ESC not allowed)         LOADER INSCR? !EXCODE 1 C,OPDB ;                                              \ marks this screen as a branch point   EXCODE:                                   LAST-DEP @ ^MARK !                      MARKS C@ 1+ DUP #MARKS < NOT            RUN-ERR" No more MARK's"                MARKS C! EX;                                                                  KEY: MARK                                 LOADER INSCR? !EXCODE ;                                              \ FAH                                                                    \ .MARKS                 < 1/20/87>187  [EXEC]                                  : .MARKS \ T -- ; T=both F=only forwrd    5 SETMODE                               IF INGXY 70 0 4 GEMIT                    8 GX +! G." Forward" ( GX @ 5 + . )     0 SETMODE 13 8 68 1 BAR                 5 SETMODE INGXY 150 0 5 GEMIT           8 GX +! G." Back"                       0 SETMODE 13 8 148 1 BAR               ELSE INGXY 100 0 4 GEMIT                 8 GX +! G." Forward"                    0 SETMODE 13 8 98 1 BAR                THEN ;                                                                        : CLR-MARKS                               2 SETMODE                               280 10 0 0 BAR                          5 SETMODE ;                                                                                                                                                                                                                          \ FAH                                                                    \ DOMARK                 < 1/20/87>188  [EXEC] 0 CONSTANT LAR?                  \ wait for <- or -> key                 \ if <- just exit                       \ if -> exit the screen immed.          EXCODE: \ -- ;                            MARKS C@ DUP 0= NOT                     IF 1 = TMARK? AND NOT THEN              DUP .MARKS TO LAR? EAT-KEYS             BEGIN KEY                                DUP 27 = ESCMARK @ 0= NOT AND           IF \ return to caller if ESC             DROP ESCMARK @ GSTACK !                 GSTACK POP DEP ! READ-SCR DROP          GSTACK POP EP ! EXIT                   THEN                                    DUP RTAR? OVER LFAR? LAR? AND OR NOT   WHILE DROP REPEAT                       CLR-MARKS RTAR? \ go to next screen     IF 1 TO EXIT-SCR? THEN EX;                                                    KEY: DOMARK                               LOADER INSCR? !EXCODE ;                                              \ FAH                                                                    \ GOMARK                 < 1/20/87>189                                                                                  EXCODE: \ -- ;                            MARKS C@                                IF TMARK? \ top = this?                  IF -1 MARKS +C! THEN                    -1 MARKS +C!                            ^MARK @ DEP ! READ-SCR                 THEN                                    EX;                                                                                                                                                           KEY: GOMARK                               LOADER INSCR? !EXCODE ;                                                                                                                                                                                                                                                                                                                                      \ FAH                                                                    \ BAR-OFFS BAR-LEN BAR-HT< 1/20/87>190  [EXEC] VARIABLE BOFFS                   CREATE BAR-LENS MAX-#MITEMS 2* ALLOT                                            EXCODE: ( N -- ) BOFFS ! EX;            KEY: BAR-OFFS                             LOADER INSCR?                           TYPES INT LOADER GET-EXPR               !EXCODE ;                                                                     EXCODE: ( N -- )                          #MITEMS @ 2* BAR-LENS + C!              10 #MITEMS @ 2* BAR-LENS + 1+ C! EX;  KEY: BAR-LEN                              LOADER INSCR?                           TYPES INT LOADER GET-EXPR               !EXCODE ;                                                                     EXCODE: ( N -- )                          #MITEMS @ 2* BAR-LENS + 1+ C! EX;     KEY: BAR-HT                               LOADER INSCR?                           TYPES INT LOADER GET-EXPR               !EXCODE ;                    \ FAH                                                                    \ MC3 UPKEY? DNKEY?      < 1/20/87>191                                          [EXEC]                                  VARIABLE AKEYS \ true is up/dn                                                  : MC3 ( -- hilight current item)          M-ITEM# @ DUP 2* BAR-LENS +             DUP 1+ C@ ' HL-HT !                     C@ SWAP {HILIT} ;                                                             : UPKEY? ( c -- t/f )                     AKEYS @ IF UPAR? ELSE LFAR? THEN ;                                            : DNKEY?                                  AKEYS @ IF DNAR? ELSE RTAR? THEN ;                                            EXIT                                                                                                                                                                                                                                                                                                                   \ FAH                                                                    \ DO-MENU3               < 1/20/87>192                                          \ args: flag C, if true use up/dn)      EXCODE: ( N -- ; if n true allow ESC )   @1ARG AKEYS ! EP @ NEXT-EP !            LAST-DEP @ NEXT-EP 2+ !                 BEGIN M-ITEM# @ 4 ^MITEMS @ GO-CODE      MC3 KEY MC3 MENU-KEY? ?DUP              IF SWAP DROP                             ^MKEYS 1+ @ GO-CODE                    ELSE DUP >R UPKEY?                       IF -1 M-ITEM# +! THEN                   R@ DNKEY?                               IF 1 M-ITEM# +! THEN                    M-ITEM# @ 1- #MITEMS @ +                #MITEMS @ MOD 1+ M-ITEM# !              R> 13 =                                 IF M-ITEM# @ 6 ^MITEMS @ GO-CODE        THEN                                   THEN                                   AGAIN                                  EX;                                                                                                            \ FAH                                                                    \ DO-MENU3 DO-MENU4      < 1/20/87>193                                          \ uses left/right arrows                KEY: DO-MENU3                             LOADER END-MENU                         !EXCODE                                 0 C,OPDB ;                                                                    \ uses up/down arrows                   KEY: DO-MENU4                             LOADER END-MENU                         !EXCODE                                 1 C,OPDB ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \ FAH                                                                    \ PATCH TO DRAW          < 3/ 6/87>194  [FORTH]                                                                         \ swith to bank 1 in ram card           \ return address                        : R1-PACKBUF ( N -- )                     R1-W1 53248 ;                                                                 REVECTOR R1-PACKBUF INTO PACKBUF        REVECTOR R2-W2      INTO PACK-DONE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ FAH                                                                    ( FIX-UP                 <10/19/87>195)                                                                                 EXCODE:                                   GSTACK SCLEAR                           CLEANUP EX;                                                                                                           KEY: FIX-UP                               LOADER INSCR? !EXCODE ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ LAST SCREEN IN LOAD    <11/ 3/86>199                                          [FORTH]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ FAH                                                                    ( TURNKEY NOTES          < 1/20/87>200)                                         EXIT ---------------------------------                                          TURNKEY draws the title screen          holt logo, prentice log, and the        directions to flip.  It then            verifies that the flip was made and     calls run to execute the program                                                Turnkey is also repsonsible for         changing the disk error words to        look for the proper disk.                                                       The word PDISK? in the disk error       words is used to check if the proper    disk is inserted                                                                                                                                                                                                                                                                                                       ( FAH  )                                                                 \ TITLE                  < 1/20/87>201  [FORTH]                                 2 CONSTANT DISK#                        : TITLE                                 \ draw the Holt logo                       HGR PAGE TEXT                           ' PICS @ >R 60 ' PICS !                 1 20 0 <DRAW> 3 0 105 <DRAW>            HG 36 EXEC WAIT FORTH                \ draw the title screen                    2 0 105 <DRAW> 2 95 GXYTAB              G." GENTICS disk " DISK# 1 =            IF G." I" ELSE G." II" THEN             56 EXEC WAIT FORTH 8 182 GXYTAB         G."  Copyright (c) 1987 Holt "          G." Rinehart Winston "                  36 EXEC WAIT FORTH                   \ Draw the prentice logo                   0 HCOLOR 280 10 0 182 BAR               4 0 105 <DRAW> 2  95 GXYTAB             G." Produced by:    "                   48 EXEC WAIT FORTH                      R> ' PICS ! ;                                                                                                                                \ FINST                  < 1/20/87>202                                          X: FINS                                    20 149 GXYTAB                           G." Insert side 2, close the disk"      20 160 GXYTAB                           G." drive door, then press RETURN."     BEGIN KEY 13 = UNTIL                 X;                                                                              X: FINST                                   0 HCOLOR 145 10 2  96 BAR                       280 71 0 109 BAR                20 118 GXYTAB                                G." Remove side 1 of the Modern Biology"                                   20 129 GXYTAB                           G." disk from the disk drive."          FINS X;                                                                                                                                                                                                                             \ FAH                                                                    \ FWRNG                  < 1/20/87>203                                          X: FWRNG                                   0 HCOLOR 280 71 0 109 BAR               20 118 GXYTAB                                G." That is not the right disk. Remove"                                    20 129 GXYTAB                           G." the disk from the disk drive."      FINS                                 X;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \ FAH                                                                    \ FLIP                   < 1/20/87>204                                          : FLIP                                     FINST                                   BEGIN PDISK? NOT                        WHILE FWRNG                             REPEAT                               ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \ FAH                                                                    \ TURNKEY                < 1/27/87>205  12866 CONSTANT DID1 ( FOR DISK 2 )      12871 CONSTANT DID2                                                             : TURNKEY                                 \ set disk error words for side 1       DID1 TO DID 3 TO DBLK 1 TO DS           \ make sure the right disk is in 1      INSDISK                                 \ set reset to restart from scratch     \ assumes ABORT points to TURNKEY       ' ABORT @ ' BRK-RETN !                  TITLE \ draw title                      \ set disk error words for side 2       DID2 TO DID 0 TO DBLK 2 TO DS           \ now flip the disk                     FLIP                                    \ set reset to jump to the menu         ' RUN CFA ' BRK-RETN !                  \ now start running virtuso code        RUN                                   ;                                                                                                                                                                                       \ REMOVE HEADS           <12/30/86>206                                                                                  FORGET FINS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \ FAH                                                                    \                        <12/29/86>207  EXIT                                    : @8K ( N -- )                            ?NUM 8 0                                DO DUP I + BLOCK                         8192 I 1024 * + 1024 CMOVE             LOOP DROP ;                                                                   : !8K ( N -- )                            ?NUM 8 0                                DO DUP I + BUFFER                        8192 I 1024 * + SWAP 1024 CMOVE         UPDATE                                 LOOP DROP FLUSH ;                                                             : QQ                                      HGR 0 0 GXYTAB                          G." Presents" GCR GCR                 ;                                                                                                                                                                                                                                                                                                                                                                                               EXIT                                    : LCKEY                                   <KEY> DUP ASCII - =                     IF <KEY> 32 + THEN                    ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ PUNNET NOTES           < 1/20/87>210                                          EXIT ---------------------------- EXIT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \ VARIABLES              < 1/27/87>211  [EXEC]                                                                          \ contains the type for the primary     \ and secondary genes for mother and    \ father (0=not used 1=AA, 2=Aa, 3=aa)    1 CONSTANT MA1                          2 CONSTANT MA2                          3 CONSTANT PA1                          3 CONSTANT PA2                                                                \ ascii code to use for each trait      \ must be upper case letter set to      \ zero if trait not used                  65 CONSTANT LET1                        66 CONSTANT LET2                                                                                                      40 XCONSTANT PLEFT \ left coordinate    11 XCONSTANT PTOP  \ Top coordinate      4 XCONSTANT MLEFT \ margin left         4 XCONSTANT MTOP  \ margin top                                                                                \ FAH                                                                    \ VARIABLES              < 1/27/87>212                                          \ controls grid size                    1 CONSTANT 4X4? \ 1=4x4 0=2x2                                                   \ cursor location within the grid       VARIABLE PUNX ( 0-4 )                   VARIABLE PUNY ( 0-4 )                                                           \ holds value of the area we are        \ currently working on                  \   0=entire square                     \   1=mother area (top row)             \   2=father area (left column)         \   3=offspring area                    \   4=father and mother area            0 CONSTANT AREA                                                                 X: GWID ( -W) 3 4X4? 0= NOT 2* + X;     X: GHT  ( -H) 3 4X4? 0= NOT 2* + X;     X: GIW  ( -W) 28 4X4? 0= NOT 16 * + X;  16 XCONSTANT GIH                                                                                                                                                                        \ DATA AREAS             < 1/20/87>213                                          XCREATE ANSWERS                            5 5 * ( grid size )                     5 * ( item length )                     ALLOT                                                                                                                EXIT ---------- notes ----------- EXIT                                          holds ascii text for data that is       in the punnett sqaure (either filled    or input)                               first byte is flags/cnt byte            next four bytes are data input                                                  bit 7 - 0=unchecked 1=checked           bit 6 - 1=right 0=wrong (if 7=1)        bit 5 - 1=wrong order,                          0=wrong gametes (if 7=1,6=1)    bit 4 - 1=created by PIFILL             bit 3 - unused                          bit 2-0 - count of input                                                                                                                        \ INAREA?                < 1/27/87>214                                          X: INSQR? ( n -- T/F; T=in square )         0 GWID 1- WITHIN X;                 X: INALL? ( X Y -- T/F; t=on square )       INSQR? SWAP INSQR? AND X;           X: INMA? ( X Y -- T/F; t=in mother)         0= SWAP INSQR? AND X;               X: INPA? ( X Y -- T/F; t=in father)         INSQR? SWAP 0= AND X;               X: INOFF? ( X Y -- T/F;t=in offspring)      1 GWID 1- WITHIN SWAP                   1 GWID 1- WITHIN AND X;             X: INPAR? ( X Y -- T/F; t=in parents )      DDUP INMA? >R INPA? R> OR X;                                                XCREATE ATESTS                           ] INALL? INMA? INPA? INOFF? INPAR? [                                           X: INAREA? ( X Y -- T/F; T=in area )       AREA 2* ATESTS + @ EXECUTE X;                                                                                                                       \ FAH                                                                    \ POS-CURS               < 1/27/87>215                                          \ adjustment for 2x2 or 4x4             X: 4ADJ ( X -- X' )                         8 4X4? 0= NOT 1+ * - X;                                                     \ position returned for where the trait \ letters should be printed             X: <POS-CUR> ( X Y -- GX GY )               DDUP INPA?                              SWAP GIH * DUP 0> IF MTOP + THEN        PTOP + >R \ in father area?             IF DROP PLEFT                           ELSE GIW * PLEFT + MLEFT + 4ADJ         THEN                                    R> X;                                                                       X: POS-CUR ( -- )                           PUNX @ PUNY @ <POS-CUR> GXYTAB X;                                                                                                                                                                                                  \ FAH                                                                    \ ERR-BOX CUR-BOX        < 1/27/87>216                                          : BOX ( W H X Y -- )                      DSWAP 1- >R 2- >R ( I'=H I=W )          OVER DUP I + 1+ SETENDPTS               DUP HLINE                ( TOP )        DUP I' + HLINE           ( BOTTOM )     OVER DUP 1+ SETENDPTS                   DUP 1+ DUP I' + 2- VLINE ( LEFT )       SWAP R> + DUP 1+ SETENDPTS              1+ DUP R> + 2- VLINE ;   ( RIGHT )                                            X: WADJ ( X -- X' ; adjust width )          PUNX @ PUNY @ INPA?                     IF 8 4X4? 0= NOT 1+ * - THEN X;                                             X: ERR-BOX ( -- ) \ orange error box        GIW 2- WADJ GIH 1-                      GX @ 4 - GY @ 3 - BOX X;                                                    X: CUR-BAR ( -- ) \ erase entry             GIW 7 - WADJ GIH 3 -                    GX @ 2 - GY @ 2- BAR X;                                                                                                                     \ PSQR                   < 1/27/87>217                                          \ draws the punnett square              X: PSQR                                     5MODE 7 HCOLOR                          \ comupte width/height of box           GIW GWID * 4ADJ 2 + MLEFT +             GIH GHT * 3 + MTOP +                    \ draw the white box                    DDUP PLEFT 6 - PTOP 5 - BAR             \ draw the vertical divider             4 HCOLOR 2 SWAP 4 -                     PLEFT 24 + 4X4? NOT IF 8 - THEN         PTOP 3 - BAR                            \ draw the horizontal divider           4 - 1 PLEFT 4 - PTOP 14 + BAR       X;                                                                                                                                                                                                                                                                                                                     \ FAH                                                                    \ AKEY? LKEY? !UNKEY     < 1/27/87>218                                          X: AKEY? ( C -- T/F; T=Arrow key)           DUP >R 8 = R@ 21 = OR                   R@ 10 = OR R> 11 = OR X;                                                    X: LKEY? ( C -- T/F; t=letter key )         TOUC DUP LET1 = OVER LET2 = OR          SWAP ASCII - = OR                   X;                                                                              XVARIABLE UNKEY                                                                 \ if T/F=T store C                      X: !UNKEY ( C T/F -- C )                    IF DUP UNKEY ! THEN X;                                                                                                                                                                                                                                                                                                                                                                                                              \ MOVE-CUR               < 1/27/87>219                                          X: MOVE-CUR ( -- T/F; T=D F=CR)            GMODE C@ >R 0 SETMODE                   BEGIN POS-CUR UNKEY @ ?DUP                IF 0 UNKEY !                           ELSE CUR-BAR KEY CUR-BAR THEN           >R PUNX @ PUNY @                        R@  8 = IF SWAP 1- SWAP THEN            R@ 21 = IF SWAP 1+ SWAP THEN            R@ 11 = IF 1- THEN                      R@ 10 = IF 1+ THEN                      DDUP OR 0= \ skip over 0 0              IF PUNX @ 0=                             IF DROP 1 SWAP ELSE DROP 1 THEN        THEN DDUP INAREA?                       IF PUNY ! PUNX !                        ELSE DDROP 800 5 TONE THEN              R@ 13 = R@ ASCII D UC= OR               R@ LKEY? OR NOT                        WHILE R> DROP REPEAT                    R> DUP LKEY? !UNKEY ASCII D UC=         R> SETMODE X;                                                       \ FAH                                                                    \ DATA ACCESS PRIMITIVES < 1/20/87>220                                          \ return adress of data for the         \ current cell                          : ^DATA ( -- ADR )                         ANSWERS                                 PUNY @ 25 * +                           PUNX @ 5 * + ;                                                               \ like count but it removes flags       \ bits from count                       X: SCOUNT ( ADR -- ADR+1 CNT )             COUNT 7 AND X;                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \ FAH                                                                    \ BIT FLAG OPERATORS     < 1/27/87>221                                          X: ?FBIT ( bit -- T/F )                    ^DATA SWAP @BIT X;                                                           X: CHKD? ( -- T/F) 7 ?FBIT X;           X: RGHT? ( -- T/F) 6 ?FBIT X;           X: ORDR? ( -- T/F) 5 ?FBIT X;           X: FILLED? ( -- T/F ) 4 ?FBIT X;                                                                                        X: !FBIT ( V BIT -- )                       SWAP >R ^DATA SWAP R> !BIT X;                                               X: !CHKD ( V -- ) 7 !FBIT X;            X: !RGHT ( V -- ) 6 !FBIT X;            X: !ORDR ( V -- ) 5 !FBIT X;            X: !FILLED ( V -- ) 4 !FBIT X;                                                                                                                                                                                                                                                                                                                          \ PISCAN PSCAN           < 1/27/87>222                                          \ for every item in the area PSCAN      \ calls with PUNX PUNY set to point     \ to this item. vectored to many things X: PISCAN ( -- )                           NOOP X;                                                                      \ set PISCAN to call word at PFA        \ Go through every item in the current  \ area and call PISCAN                  X: PSCAN ( PFA -- )                        CFA X' PISCAN !                         GHT 0                                   DO GWID 0                                 DO I J INAREA?                          I 0= J 0= AND NOT AND                   IF I PUNX ! J PUNY !                     PISCAN                                 THEN                                   LOOP                                   LOOP X;                                                                                                                                                                              \ PIBOX PIDRAW PDRAW     < 1/27/87>223                                          X: PIBOX ( -- ; draw proper box )          POS-CUR 1MODE ERR-BOX \ erase cur       5MODE CHKD? RGHT? NOT AND               IF ORDR? 0=                              IF 6 ELSE 15 THEN                       HCOLOR ERR-BOX                         THEN X;                                                                      \ draw item at PUNX, PUNY               X: PIDRAW ( -- ; draw text )               PIBOX 1MODE CUR-BAR                     3MODE ^DATA SCOUNT GTYPE                5MODE X;                                                                     \ draw all items in current area        X: PDRAW                                   X' PIDRAW PSCAN X;                                                                                                                                                                                                                                                                                           \ FILL PRIMS             < 1/27/87>224                                          \ compute letter for first trait        \ if GT=2  n=1,2 is UC, n=3,4 if LC     X: @PLET ( GT N LET -- LET )               SWAP >R SWAP DUP 3 =                    SWAP 2 = R> 2 > AND OR                  IF 32 + THEN X;                                                              \ same as @PLET but orders differntly   \ if GT=2  n=1,3 is UC, n=2,4 if LC     X: @SLET ( GT N LET -- LET )               SWAP >R SWAP DUP 3 =                    SWAP 2 = R> 1 AND 0= AND OR             IF 32 + THEN X;                                                                                                                                                                                                                                                                                                                                                                                     \ FAH                                                                    \ FILL PRIMS             < 1/27/87>225                                          X: ILEN ( -- N ; len of field )            PUNX @ 0= PUNY @ 0= OR NOT 1+ 2*        4X4? NOT IF 2/ THEN X;                                                       X: @PXY ( -- X Y )                         PUNX @ PUNY @ X;                                                             \ return area of item to store into     X: LAREA ( -- ADR )                        ^DATA X;                                                                     XVARIABLE LOFS                          \ store letter into data string         \ 0=CNT/FLG 1=first byte of string      X: !LET ( V O -- )                         DUP LOFS ! LAREA + C! X;                                                     \ store to the next letter              X: !NLET ( V -- )                          LOFS @ 1+ !LET X;                                                                                           \ FAH                                                                    \ SRTANS                 < 1/27/87>226                                          \ make sure cap letters are first       X: ORD ( ADR -- )                          DUP >R C@ R@ 1+ C@ DDUP >               IF SWAP THEN                            R@ 1+ C! R> C! X;                                                            \ works only for offsprings             X: SRTANS ( ADR -- )                       SCOUNT OVER ORD 2 >                     IF DUP 2+ ORD                             DUP C@ LET1 UC= NOT                     IF DUP >R D@ SWAP R@ D! R>              THEN DROP                             ELSE DROP THEN X;                                                            \ works only for parents                X: SRTPAR ( ADR -- )                       COUNT 1 > OVER C@ LET2 UC= AND          IF DUP >R C@                             R@ 1+ C@ R@ C! R> 1+ C!                ELSE DROP                               THEN X;                                                                                              \ PIFILL                 < 1/27/87>227                                          \ fill current item based on the        \ genotypes in MA1, MA2, PA1, PA2       \ NOTE -- LAREA may be vectored --      X: PIFILL ( -- ; Fill in item )            208 ILEN + 0 !LET 4X4?                  IF @PXY INPA? NOT                        IF MA1 PUNX @ LET1 @PLET !NLET THEN     @PXY INMA? NOT                          IF PA1 PUNY @ LET1 @PLET !NLET THEN     @PXY INPA? NOT                          IF MA2 PUNX @ LET2 @SLET !NLET THEN     @PXY INMA? NOT                          IF PA2 PUNY @ LET2 @SLET !NLET THEN    ELSE \ 2X2?                              @PXY INPA? NOT                          IF MA1 PUNX @ LET1 @SLET !NLET THEN     @PXY INMA? NOT                          IF PA1 PUNY @ LET1 @SLET !NLET THEN    THEN                                    @PXY INOFF?                             IF LAREA SRTANS THEN                 X;                                                                                                      \ PFILL                  < 1/27/87>228                                                                                  \ fill in all in current area           X: PFILL                                   ' ^DATA CFA X' LAREA !                  X' PIFILL PSCAN X;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \ FAH                                                                    \ PINPUT PRIMS           < 1/27/87>229                                          0 XCONSTANT PML \ max length            0 XCONSTANT PA  \ string adress         XVARIABLE LCNXT \ 1=make next lowercase                                         X: DELC ( -- ; delete last character )     -1 PA +C! PA COUNT + C@                 DUP CWIDTH CDELX + NEGATE GX +!         GMODE C@ 1 OVER 5 = + SETMODE           SWAP >CDATA @CURSOR CDRAW               SETMODE X;                                                                   X: ADDC ( C -- ; print c store in str )    DUP ASCII A ASCII Z WITHIN              LCNXT @ AND IF 32 + THEN                DUP PA COUNT + C!                       1 PA +C!                                ( C ) GEMIT X;                       EXIT                                    X: AKEY2? ( C -- ; glue logic word )       DUP 8 = IF DROP PA C@ 0=                ELSE AKEY? THEN X;                                                                                                                           \ PINPUT                 < 1/27/87>230  \ input routine that will only input    \ upper/lower case version of LET1 LET2                                         X: PINPUT ( ADR LEN -- )                   X' PML ! X' PA ! 0 PA C! 0 LCNXT !      BEGIN UNKEY @ ?DUP                       IF 0 UNKEY ! ELSE GKEY THEN             DUP 13 = ( OVER AKEY2? OR ) NOT        WHILE >R                                 R@ 8 = R@ 127 = OR PA C@ 0> AND         IF \ del key & something to delete       DELC                                   ELSE \ check if valid key and room       R@ 0= NOT PA C@ PML < AND               R@ LKEY? AND                            IF R@ ADDC 0 LCNXT !                    ELSE R@ ASCII - = DUP LCNXT ! NOT        IF 800 5 TONE THEN                    THEN THEN                               R> DROP                                REPEAT                                  DUP AKEY? !UNKEY DROP X;                                            \ FAH                                                                    \ PGET PRIMS             < 5/26/87>231  XCREATE PPOS \ if not zero start <PGET>    -1 , 0 ,   \ at this coordinats      XCREATE AHOME \ start pos for areas       1 C, 1 C,   1 C, 0 C,   0 C, 1 C,       1 C, 1 C,   1 C, 0 C,                                                            \ are we allowed to get this item?   X: PTEST ( -- T/F ) NOOP X;                \ PTEST when in FIX mode             X: FPTEST RGHT? NOT X;                     \ PTEST when in GET mode             X: GPTEST FILLED? NOT X;                                                        X: PGET-POS ( -- )                         PPOS @ 1+                               IF PPOS D@ PUNY ! PUNX ! -1 PPOS !      ELSE AREA 2* AHOME + DUP                 C@ PUNX ! 1+ C@ PUNY !                 THEN X;                                                                                                                                                                                                                                                              \ PGET PFIX              < 5/26/87>232                                          \ homes cursor and inputs until         \ D is pressed while moving             X: <PGET> ( -- )                           PGET-POS                                BEGIN MOVE-CUR NOT                      WHILE PTEST \ can we input to this?      IF POS-CUR 5MODE 4 HCOLOR CUR-BAR        ^DATA ILEN PINPUT                       POS-CUR 0MODE CUR-BAR                  ELSE 0 UNKEY ! THEN                    REPEAT                                  5MODE X;                                                                     X: PGET \ input/change anything in area    X' GPTEST CFA X' PTEST !                <PGET> X;                                                                    X: PFIX \ input/change whats wrong         X' FPTEST CFA X' PTEST !                <PGET> X;                                                                                                   \ DAN                                                                    \ PCHECK prims           < 1/27/87>233                                          \ stays 1 if all items are correct      0 XCONSTANT ALLRT?                                                              \ build correct answer string here      XCREATE CANS 5 ALLOT                                                            \ build sorted version of user input    XCREATE SANS 5 ALLOT                                                                                                    \ check string at ADR against CANS      X: ICHK ( ADR -- T/F; t= matchs CANS )     DUP C@ 7 AND CANS C@ 7 AND =            IF ILEN 1+ 1                             DO DUP I + C@ CANS I + C@ = NOT          IF DROP 0 LEAVE THEN                   LOOP                                    0= NOT                                 ELSE DROP 0 THEN X;                                                                                                                                 \ FAH                                                                    \ PICHECK PCHECK         < 1/27/87>234                                          X: PICHECK ( -- )                          CHKD? NOT                               IF X' CANS CFA X' LAREA !                PIFILL \ build correct ans at CANS       ^DATA ICHK NOT \ if incorrect          IF 0 !RGHT 0 X' ALLRT? !                 \ if sorted answer is correct           \ then only order is wrong              ^DATA SANS 5 CMOVE @PXY INOFF?          IF SANS SRTANS                          ELSE SANS SRTPAR THEN                   SANS ICHK !ORDR                        ELSE 1 !RGHT THEN                       1 !CHKD PIBOX \ draw new box           ELSE RGHT? NOT                           IF 0 X' ALLRT? ! THEN                  THEN X;                                                                      X: PCHECK                                  1 X' ALLRT? !                           X' PICHECK PSCAN X;                                                                                                                          \ PICLEAR PCLEAR         < 1/27/87>235                                          \ clear data item                       X: PICLEAR                                 0 ^DATA C! X;                                                                X: PCLEAR                                  X' PICLEAR PSCAN X;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \ PRIM-GRS               < 3/ 9/87>236                                          [EXEC]                                  XCREATE GNS \ Graphic numbers            0 C, \ 2x2: TT  4x4: TTAA               0 C, \      tt       ttAA               0 C, \               TTaa               0 C, \               ttaa                                                      XCREATE GADRS \ Load address             0 , 0 , 0 , 0 ,                                                                EXCODE: ( D R -- )                        GNS 1+ C! GNS C!                        0 GNS 2 + ! \ Clear SEC-GRS             CLEANUP EX;                                                                   [KEYWORDS]                              : PRIM-GRS                                 LOADER INSCR?                           TYPES INT LOADER GET-EXPR               TYPES INT LOADER GET-EXPR               !EXCODE ;                                                           \ FAH                                                                    \ SEC-GRS                < 3/ 6/87>237                                          EXCODE: ( D R -- )                        GNS 3 + C! GNS 2+ C!                    CLEANUP EX;                                                                   [KEYWORDS]                              : SEC-GRS                                  LOADER INSCR?                           TYPES INT LOADER GET-EXPR               TYPES INT LOADER GET-EXPR               !EXCODE ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \ GET-PHENOS             < 3/ 9/87>238                                          EXCODE: ( -- )                            GADRS 8 0 FILL PACKBUF 4 0              DO GNS I + C@ DUP                        IF OVER GADRS I 2* + ! \ save start       DUP >R @P-START OVER                    R@ @P-SIZE DISK>                        R> @P-SIZE THEN                       + \ point to next free                 LOOP                                    DROP PACK-DONE                        EX;                                                                             [KEYWORDS]                              : GET-PHENOS                               LOADER INSCR? !EXCODE ;                                                                                                                                                                                                                                                                                             \ FAH                                                                    \ @GT NDRAW              < 3/ 9/87>239                                          [EXEC] \ Examines the 2 letter pair     \ starting at ADR and determines the    \ genotype by examining the case        \ N=0 if dominant, n=1 if recesive?     X: @GT ( ADR -- N )                        DUP C@ ASCII Z >                        SWAP 1+ C@ ASCII Z > AND X;                                                  X: DRPHEN ( N -- ; 0<=N<=3 )               2* GADRS + @ ?DUP                       IF PACKBUF DROP                          GX @ 7 / GY @ UNPACK PACK-DONE         THEN X;                                                                      EXCODE: ( N -- ) DRPHEN EX;                                                     [KEYWORDS] \ USE: NDRAW n               : NDRAW                                    LOADER INSCR?                           TYPES INT LOADER GET-EXPR               !EXCODE ;                                                                                                                                    \ PUN-OFFS               < 3/ 9/87>240  [EXEC]                                  X: OFFID# ( adr -- N; 0-3)                DUP 1+ @GT 4X4?                         IF 2* SWAP 3 + @GT +                    ELSE SWAP DROP THEN X;                                                        \ draw proper graphic at cursor pos     EXCODE: ( N ; N<=0<=15 )                  4X4?                                    IF 4 /MOD ELSE 4 MOD 2 /MOD THEN        1+ PUNX ! 1+ PUNY !                     X' CANS CFA X' LAREA !                  PIFILL \ Generate correct ans           \ generate an index into graph nums     CANS OFFID# DRPHEN                      CLEANUP EX;                                                                   [KEYWORDS]                              : PUN-OFFS                                 LOADER INSCR?                           TYPES INT LOADER GET-EXPR               !EXCODE ;                                                                                                                                    \ TR-LETS                < 3/ 6/87>241                                                                                  EXCODE: ( L1 L2 -- )                      DUP 0= NOT TO 4X4?                      ' LET2 ! ' LET1 ! EX;                                                         \ use: TR-LETS L1 , L2                  KEY: TR-LETS                              LOADER INSCR?                           TYPES INT LOADER GET-EXPR               TYPES INT LOADER GET-EXPR               !EXCODE ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \ FAH                                                                    \ MOTHER FATHER          < 3/ 6/87>242                                          [EXEC]                                  X: TVAL ( N -- 'N )                        DUP 4 =                                 IF DROP 3 RANDOM 1+ THEN X;                                                  \ USE: MOTHER prim , sec.               EXCODE: ( P S -- )                         TVAL TO MA2 TVAL TO MA1 EX;          KEY: MOTHER                               LOADER INSCR?                           TYPES INT LOADER GET-EXPR               TYPES INT LOADER GET-EXPR               !EXCODE ;                                                                     \ USE: FATHER prim , sec.               EXCODE: ( P S -- )                         TVAL TO PA2 TVAL TO PA1 EX;          KEY: FATHER                               LOADER INSCR?                           TYPES INT LOADER GET-EXPR               TYPES INT LOADER GET-EXPR               !EXCODE ;                    \ FAH                                                                    \ PUN-POS PUN-SQUARE     < 2/25/87>243                                          EXCODE: ( X Y -- )                        X' PTOP ! X' PLEFT ! EX;                                                      \ use: PUN-POS x y                      KEY: PUN-POS                              LOADER INSCR?                           TYPES INT LOADER GET-EXPR               TYPES INT LOADER GET-EXPR               !EXCODE ;                                                                                                             EXCODE: ( -- )                            PSQR CLEANUP EX;                                                              KEY: PUN-SQUARE                           LOADER INSCR? !EXCODE ;                                                                                                                                                                                                                                                      \ FAH                                                                    \ PUN-CLEAR PUN-FILL     < 2/25/87>244                                          EXCODE: ( area )                          TO AREA PCLEAR CLEANUP EX;                                                    \ use: PUN-CLEAR area                   KEY: PUN-CLEAR                            LOADER INSCR?                           TYPES INT LOADER GET-EXPR               !EXCODE ;                                                                                                                                                     EXCODE: ( area )                          TO AREA PFILL CLEANUP EX;                                                     \ use: PUN-FILL area                    KEY: PUN-FILL                             LOADER INSCR?                           TYPES INT LOADER GET-EXPR               !EXCODE ;                                                                                                                                            \ FAH                                                                    \ PUN-DRAW PUN-GET       < 2/25/87>245                                          EXCODE: ( area )                          TO AREA PDRAW CLEANUP EX;                                                     \ use: PUN-DRAW area                    KEY: PUN-DRAW                             LOADER INSCR?                           TYPES INT LOADER GET-EXPR               !EXCODE ;                                                                                                                                                     EXCODE: ( area )                          TO AREA PGET CLEANUP EX;                                                      \ use: PUN-GET area                     KEY: PUN-GET                              LOADER INSCR?                           TYPES INT LOADER GET-EXPR               !EXCODE ;                                                                                                                                            \ FAH                                                                    \ PUN-ERRS               < 2/25/87>246                                          EXCODE: ( area )                          TO AREA PCHECK                          ALLRT? FLAG C!                          CLEANUP EX;                                                                   \ use: PUN-ERRS area                    KEY: PUN-ERRS                             LOADER INSCR?                           TYPES INT LOADER GET-EXPR               !EXCODE ;                                                                                                                                                     EXCODE: ( area )                          TO AREA PFIX CLEANUP EX;                                                      \ use: PUN-FIX area                     KEY: PUN-FIX                              LOADER INSCR?                           TYPES INT LOADER GET-EXPR               !EXCODE ;                                                            \ FAH                                                                    \ 1PUN-FILL              < 5/26/87>247                                          EXCODE: ( PX PY -- )                      PUNY ! PUNX !                           ' ^DATA CFA X' LAREA !                  PIFILL \ gen correct answer in array    PIDRAW \ print it                       CLEANUP EX;                                                                   \ use: 1PUN-FILL punx , puny            \ Generates correct answer in answers   \ array and prints it on the screen     KEY: 1PUN-FILL                             LOADER INSCR?                           TYPES INT LOADER GET-EXPR               TYPES INT LOADER GET-EXPR               !EXCODE ;                                                                                                                                                                                                                                                                                                                                                                                    \ PUN-START              < 5/26/87>248                                          EXCODE: ( PX PY -- )                      PPOS D!                                 CLEANUP EX;                                                                   \ use: PUN-START punx , puny            \ if specified, indicates starting      \ coordinates for PUN-GET PUN-FIX       \ resets to default (top of current     \ area) each time PUN-GET PUN-FIX\      \ is called                             KEY: PUN-START                             LOADER INSCR?                           TYPES INT LOADER GET-EXPR               TYPES INT LOADER GET-EXPR               !EXCODE ;                                                                                                                                                                                                                                                                                                                                                                                    \ MSGS                   < 5/28/87>249                                          EXCODE: ( S E -- )                        1+ SWAP                                 DO I G.GMSG DONL                        LOOP                                    CLEANUP EX;                                                                   \ use: MSGS S E                         \ print from msg S to msg E (inclusive) \ with a NL between each                KEY: MSGS                                  LOADER INSCR?                           TYPES INT LOADER GET-EXPR               TYPES INT LOADER GET-EXPR               !EXCODE ;                                                                                                                                                                                                                                                                                                                                                                                                                            \                        < 6/ 4/87>250  \ print let (LC if fl is true)          \ centered at offset from current       \ cursor position                       \ (CURSOR IS UNCHANGED)                                                         [EXEC]                                  14 CONSTANT LOFS                        : .POLET ( fl let yo -- )                  GETMODE >R GXY@ >R >R 4 SETMODE         GY +! \ F L                             SWAP 0= NOT 32 * +                      DUP >CDATA C@ 2/ NEGATE                 GX @ DUP 7 MOD - + LOFS + GX !          GEMIT                                   R> R> GXYTAB R> SETMODE ;                                                    EXIT                                    : ZZ 34 GX @ 7 / GY @ <DRAW> ;                                                    CURX CURY                                                                                                                                                                                                                     \ PUN-OFFS2              < 6/ 2/87>251                                          \ draw proper graphic at cursor pos     EXCODE: ( N ; N<=0<=15 )                  4X4?                                    IF 4 /MOD ELSE 4 MOD 2 /MOD THEN        1+ PUNX ! 1+ PUNY !                     X' CANS CFA X' LAREA !                  PIFILL \ Generate correct ans           \ generate an index into graph nums     PACKBUF GX @ 7 / GY @ UNPACK            PACK-DONE                               CANS 1+ @GT LET1 4 .POLET               4X4?                                    IF CANS 3 + @GT LET2 18 .POLET          THEN CLEANUP EX;                                                              [KEYWORDS]                              : PUN-OFFS2                                LOADER INSCR?                           TYPES INT LOADER GET-EXPR               !EXCODE ;                                                                                                   \ FAH                                                                    \                        < 6/ 5/87>252                                          [EXEC]                                  CREATE CRATIO 8 ALLOT                                                           \ Fills 4 byte CRATIO array with the    \ raw count of offspring produced       \ with current parents. Last two        \ entries unused if not a 4x4 crosss    X: SET-RATIO ( -- )                       CRATIO 4 0 FILL 16 0                    DO I 4X4?                                IF 4 /MOD ELSE 4 MOD 2 /MOD THEN        1+ PUNX ! 1+ PUNY !                     X' CANS CFA X' LAREA ! PIFILL           1 CANS OFFID# CRATIO + +C!             LOOP X;                                                                                                                                                                                                                                                                                                                                                                                       \                        < 6/ 5/87>253                                          \ f=0 if n1-n4 are all divisible by div X: DVS \ n1 n2 n3 n4 div -- f              >R R@ MOD SWAP R@ MOD OR ROT ROT        R@ MOD SWAP R> MOD OR OR X;                                                  \ Greatest common denominator of n1-n4  X: GCD \ n1 n2 n3 n4 -- 0<n<16             0 16 DO                                  DOVER DOVER I DVS 0=                    IF DDROP DDROP I LEAVE THEN            -1 /LOOP X;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \                        < 6/ 5/87>254                                          \ @s n1-n8 from CRATIO                  X: @RATIO \ -- n1 n2 n3 n4 n5 n6 n7 n8     8 0 DO CRATIO I + C@ LOOP X;                                                 \ f=1 will start ! at CRATIO + 4        X: !RATIO \ n1 n2 n3 n4 f --               4 * 3 + CRATIO + 4 0                    DO SWAP OVER C! 1-                      LOOP DROP X;                                                                 \ n1 n2 n3 n4 -- n1' n2' n3' n4'        X: 4RDC                                    DOVER DOVER GCD >R                      R@ / SWAP R@ / SWAP DSWAP               R@ / SWAP R> / SWAP DSWAP X;                                                 \ Reduces boths sets of ratio of CRATIO X: RDC-RATIO \ --                          @RATIO 4RDC 1 !RATIO                    4RDC 0 !RATIO X;                                                                                                                                                                     \ GET-RATIO PRT-RATIO    < 6/ 5/87>255                                          EXCODE: \ n -- 0 < n < 3                   CRATIO 4 + +                            0 16 PAD 2 GETN DUP TINT !              SWAP C! CLEANUP EX;                                                          KEY: GET-RATIO                             LOADER INSCR?                           TYPES INT LOADER GET-EXPR               !EXCODE ;                                                                    EXCODE: \ 0/1 --                           4 * CRATIO + 4 0                        DO DUP I + C@ G.                         I 3 < IF ASCII : GEMIT THEN            LOOP DROP EX;                                                                KEY: PRT-RATIO                             LOADER INSCR?                           TYPES INT LOADER GET-EXPR               !EXCODE ;                                                                                                                                                                            \ ERR-RATIO              < 6/ 5/87>256  \ Reduces both sets of ratio and set    \ FLAG if both sets are equal           EXCODE: \ --                              SET-RATIO RDC-RATIO                     @RATIO DSWAP >R >R D=                   ROT ROT R> R> D=                        AND FLAG C! CLEANUP EX;                                                       KEY: ERR-RATIO                             LOADER INSCR? !EXCODE ;                                                      \ set TINT to sum of ratios             EXCODE: ( -- )                            0 8 4                                   DO CRATIO I + C@ + LOOP                 TINT ! EX;                                                                    KEY: SUM-RATIO                             LOADER INSCR? !EXCODE ;                                                                                                                                                                                                                                              \ RANDOM                 < 1/20/87>257                                          \ Set TINT to be n RANDOM               EXCODE: \ n --                            RANDOM TINT ! CLEANUP EX;                                                     KEY: RAND                                  LOADER INSCR?                           TYPES INT LOADER GET-EXPR               !EXCODE ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \ FAH                                                                    \ NSAVE NLOAD            < 1/20/87>258  EXIT THIS FOR NOW                                                               [FORTH]                                                                         \ set new data stack pointer            CODE !SP ( ADR -- )                       BOT LDA, TAX,                           NEXT JMP, C;                                                                  \ loads array with n items from the     \ stack, top of stack is first entry    : NSAVE ( <N INTS> ADR N -- )             >R SP@ 2+ SWAP R@ 2* CMOVE              SP@ R> 2* + !SP ;                                                             : NLOAD ( ADR N -- <n ints> )             >R >R \ I'=n I=src                      SP@ I' 2* - !SP                         SP@ R> SWAP R> 2* CMOVE ;                                                                                                                                                                                                                                             \ SAVEPUN                < 1/20/87>259  EXIT THIS FOR NOW                       [EXEC]                                                                          XCREATE PUN-SAV                           24 ALLOT \ variables (some extra)      125 ALLOT \ answers array                                                                                              EXCODE: ( -- )                            MA1 MA2 PA1 PA2    \ constants          4X4? AREA          \ constants          LET1 LET2          \ constants          PUNX @ PUNY @                           PUN-SAV 10 NSAVE                        ANSWERS PUN-SAV 125 CMOVE             EX;                                                                             KEY: SAVEPUN                              LOADER INSCR? !EXCODE ;                                                                                                                                                                                                                                               \ RESTPUN                < 1/20/87>260  EXIT THIS FOR NOW                                                               EXCODE: ( -- )                            PUN-SAV 10 NLOAD                        PUNY ! PUNX !                           ' LET2 ! ' LET1 !                       TO AREA TO 4X4?                         TO PA2 TO PA1 TO MA2 TO MA1             PUN-SAV ANSWERS 125 CMOVE             EX;                                                                             KEY: RESTPUN                              LOADER INSCR? !EXCODE ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ REMOVE HEADS           < 1/20/87>261                                                                                  [FORTH]                                                                         FORGET PLEFT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \ FAH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \ TEST PUN-OFFS2         < 6/ 2/87>265                                          VARIABLE INT XOFF                       BEGIN                                                                             TR-LETS "A" , "R"                       MOTHER 1 , 2                            FATHER 3 , 4                                                                    LET TINT := 0                           BEGIN                                    IF TINT < 8 THEN                         AT 28 * TINT , 50                      ELSE                                     AT 28 * ( TINT - 7 ) , 100             ENDIF                                                                           PUN-OFFS2 TINT                          LET TINT := TINT + 1                                                            IF TINT = 16 SCREEN-DONE                REPEAT                                 END                                   END                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \                        < 1/22/87>270  FORGET Q                                : Q                                       BEGIN HG                                 TEXT                                   AGAIN ;                                                                                                               HEX CODE Q2                              C057 LDA, C052 LDA,                     BEGIN, C051 LDA,                         \ Try 1,6,7                             C050 LDA,                               NOP, NOP, NOP, NOP,                    AGAIN, C;                              DECIMAL                                                                                                                                                                                                                                                                                                                                                                                                                                 \                        < 1/27/87>271                                                                                  BEGIN                                     PUN-POS 48 , 19                         PUN-CLEAR 0                             TR-LETS 65 , 0                          MOTHER 4 , 4   FATHER 4 , 4             PUN-SQUARE                              PUN-FILL 4   PUN-DRAW 4                 PUN-GET 3    PUN-ERRS 3                                                         BEGIN                                    IF FLAG DONE                            PUN-FIX 3 PUN-ERRS 3 REPEAT            END                                     AT 0 , 0 PRINT "DONE!"                END                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \ EXPLODE                < 5/15/86>276  \ use: EXPLODE type                     \ 1=Implosion type 3                    \ 2=Implosion type 4                    \ 3=Explosion type 1                    \ 4=Explosion type 2                                                            EXCODE: \ T --                            GXY@  BY ! BX !                         DUP 2 > TO E/I                          1 AND IF EI1 ELSE EI2 THEN              CLEANUP                               EX;                                                                             KEY: EXPLODE                              LOADER INSCR?                           TYPES INT LOADER GET-EXPR               !EXCODE ;                                                                                                             FORGET {BLW}                                                                                                                                           \ FAH                                                                    ( LOAD BRODY FONT        < 3/16/86>277)                                         CR CR ." LOADING BRODY FONT " 2BEEP     CR CR 2BEEP                                                                     CREATE BRODYFONT 1624 ALLOT                                                     BRODYFONT ' ASCTAB !                                                                                                    BLK @ 1+ BLOCK ASCTAB        1024 CMOVE BLK @ 2+ BLOCK ASCTAB 1024 +  600 CMOVE                                                                                 EXIT                                                                                                                                                                                                                                                                                                                                                                                                   ( bobp ) U]U]U]www3;www3	               
     % 1 = R g                                                           	!-9EQ]r~&2GS_kw.:FR^s            	!-9EZfr~#  8	             	UUUUUUU  		p ~c~     	?  	?  		  @ @@@      	           	    Cco0 C3 6 _c       	         o	   o	       o		l l l l l     _	 ~ [ x [~    _
	[n 0 XlF    _	 6 <  3 s ^    _	        	   	   	 3?3    	 ?    	        	         	         	@` 0         _	33333   	   	308?   	3003   	 08<60   	?303   	833   	0   	3333   	33>   	        	       	     	        	     	30    	|3[[6    _	66c  	3333  	66  	33333  	  	  	6csf<  	333?333  	  	  	33  	  		Go;    _	CGO[scC    _	6ccc6  	333  	 6 c c s v \    _	3333   	303   	?   	333333   	CCf f < <      _		;oG    _	3333  	CCf <        _	?0?   	  nscsn   	;gcg;   	  33   	``nscsn   	  >c?~   	<?   	  nscsn`> 	;gccc   	    	  	33   	   
	    O3333    _	  3333  	  333  	  ;gcg;	  nscsn``	    	  >0  	?  	  3333>  	  cc66  
	    3333N    _	  33  	  33	  ??  	  	  	  		s              _		p ~c~                                                                                                                                                                                                                                                                                                                                                                                                                  	!	RGCUQQ6D